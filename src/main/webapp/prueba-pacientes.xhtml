<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Prueba Guardar Paciente - DEBUGGING</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .campo { margin-bottom: 15px; }
        .campo label { display: block; font-weight: bold; margin-bottom: 5px; }
        .campo input, .campo select, .campo textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .btn { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
    </style>
</h:head>

<h:body>
    <div class="container">
        <h1> Formulario de Prueba - Guardar Paciente</h1>

        <h:form id="testForm">

            <!-- MENSAJES -->
            <p:messages id="msgs" autoUpdate="true" closable="true"/>

            <h2> Datos del Paciente</h2>

            <!-- DPI -->
            <div class="campo">
                <h:outputLabel for="dpi" value="DPI (13 d铆gitos):"/>
                <p:inputText id="dpi"
                             value="#{pacientesBean.nuevoPaciente.dpi}"
                             required="true"
                             requiredMessage="El DPI es obligatorio"
                             placeholder="Ej: 1234567890123"/>
            </div>

            <!-- NOMBRE -->
            <div class="campo">
                <h:outputLabel for="nombre" value="Nombre:"/>
                <p:inputText id="nombre"
                             value="#{pacientesBean.nuevoPaciente.nombre}"
                             required="true"
                             requiredMessage="El nombre es obligatorio"
                             placeholder="Ej: Juan"/>
            </div>

            <!-- APELLIDO -->
            <div class="campo">
                <h:outputLabel for="apellido" value="Apellido:"/>
                <p:inputText id="apellido"
                             value="#{pacientesBean.nuevoPaciente.apellido}"
                             required="true"
                             requiredMessage="El apellido es obligatorio"
                             placeholder="Ej: P茅rez"/>
            </div>

            <!-- FECHA DE NACIMIENTO -->
            <div class="campo">
                <h:outputLabel for="fechaNac" value="Fecha de Nacimiento:"/>
                <p:calendar id="fechaNac"
                            value="#{pacientesBean.nuevoPaciente.fechaNacimiento}"
                            pattern="dd/MM/yyyy"
                            converter="localDateConverter"
                            required="true"
                            requiredMessage="La fecha de nacimiento es obligatoria"
                            showButtonBar="true"
                            navigator="true"
                            yearRange="1920:2024"/>
            </div>

            <!-- TELFONO -->
            <div class="campo">
                <h:outputLabel for="tel" value="Tel茅fono:"/>
                <p:inputText id="tel"
                             value="#{pacientesBean.nuevoPaciente.contacto}"
                             required="true"
                             requiredMessage="El tel茅fono es obligatorio"
                             placeholder="Ej: 12345678"/>
            </div>

            <!-- CORREO -->
            <div class="campo">
                <h:outputLabel for="email" value="Correo Electr贸nico:"/>
                <p:inputText id="email"
                             value="#{pacientesBean.nuevoPaciente.correo}"
                             placeholder="Ej: paciente@email.com"/>
            </div>

            <!-- DIRECCIN -->
            <div class="campo">
                <h:outputLabel for="dir" value="Direcci贸n:"/>
                <p:inputTextarea id="dir"
                                 value="#{pacientesBean.nuevoPaciente.direccion}"
                                 rows="2"
                                 required="true"
                                 requiredMessage="La direcci贸n es obligatoria"
                                 placeholder="Ingrese la direcci贸n completa"/>
            </div>

            <!-- ALERGIAS -->
            <div class="campo">
                <h:outputLabel for="alerg" value="Alergias:"/>
                <p:inputText id="alerg"
                             value="#{pacientesBean.nuevoPaciente.alergias}"
                             placeholder="Ej: Penicilina, Polen"/>
            </div>

            <!-- CONDICIONES -->
            <div class="campo">
                <h:outputLabel for="cond" value="Condiciones M茅dicas:"/>
                <p:inputTextarea id="cond"
                                 value="#{pacientesBean.nuevoPaciente.condiciones}"
                                 rows="2"
                                 placeholder="Ej: Diabetes, Hipertensi贸n"/>
            </div>

            <!-- OBSERVACIONES -->
            <div class="campo">
                <h:outputLabel for="obs" value="Observaciones:"/>
                <p:inputTextarea id="obs"
                                 value="#{pacientesBean.nuevoPaciente.observaciones}"
                                 rows="2"
                                 placeholder="Notas adicionales"/>
            </div>

            <h2>Ψ Asignaciones</h2>

            <!-- ODONTLOGO -->
            <div class="campo">
                <h:outputLabel for="odont" value="Odont贸logo:"/>
                <p:selectOneMenu id="odont"
                                 value="#{pacientesBean.odontologoId}"
                                 required="true"
                                 requiredMessage="Debe seleccionar un odont贸logo">
                    <f:selectItem itemLabel="-- Seleccione un odont贸logo --" itemValue="#{null}" noSelectionOption="true"/>
                    <f:selectItems value="#{pacientesBean.odontologos}"
                                   var="od"
                                   itemLabel="#{od.nombreCompleto}"
                                   itemValue="#{od.id}"/>
                </p:selectOneMenu>
            </div>

            <!-- SEGURO -->
            <div class="campo">
                <h:outputLabel for="seg" value="Tipo de Seguro:"/>
                <p:selectOneMenu id="seg"
                                 value="#{pacientesBean.seguroSeleccionado}"
                                 required="true"
                                 requiredMessage="Debe seleccionar un tipo de seguro">
                    <f:selectItem itemLabel="-- Seleccione tipo de seguro --" itemValue="#{null}" noSelectionOption="true"/>
                    <f:selectItems value="#{pacientesBean.seguros}"/>
                </p:selectOneMenu>
            </div>

            <h2> Acciones</h2>

            <!-- BOTONES -->
            <p:commandButton value=" Guardar con AJAX"
                             action="#{pacientesBean.guardarPaciente}"
                             update="msgs tablaPacientes"
                             process="@form"
                             styleClass="btn btn-primary"
                             icon="pi pi-save"/>

            <p:commandButton value=" Guardar SIN AJAX"
                             ajax="false"
                             action="#{pacientesBean.guardarPaciente}"
                             styleClass="btn btn-success"
                             icon="pi pi-save"
                             style="margin-left: 10px;"/>

            <h2> Pacientes Registrados</h2>

            <!-- TABLA -->
            <p:dataTable id="tablaPacientes"
                         value="#{pacientesBean.pacientes}"
                         var="p"
                         paginator="true"
                         rows="5"
                         emptyMessage="No hay pacientes registrados">

                <p:column headerText="ID" style="width: 50px;">
                    <h:outputText value="#{p.id}"/>
                </p:column>

                <p:column headerText="DPI">
                    <h:outputText value="#{p.dpi}"/>
                </p:column>

                <p:column headerText="Nombre Completo">
                    <h:outputText value="#{p.nombreCompleto}"/>
                </p:column>

                <p:column headerText="Tel茅fono">
                    <h:outputText value="#{p.contacto}"/>
                </p:column>

                <p:column headerText="Odont贸logo">
                    <h:outputText value="#{p.odontologo != null ? p.odontologo.nombreCompleto : 'Sin asignar'}"/>
                </p:column>

                <p:column headerText="Seguro">
                    <h:outputText value="#{p.seguro}"/>
                </p:column>

            </p:dataTable>

        </h:form>
    </div>
</h:body>
</html>